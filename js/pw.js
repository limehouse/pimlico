const me = {
  contact : {
    firstname : "Phillip",
    surname : "Webb",
    phone : "07719 123327",
    email : "phillip.webb@nntp.uk",
    link : {
      url: "https://www.linkedin.com/in/iamphillipwebb", text: "iamphillipwebb"
    },
    about : [
      "A developer with strong foundation in HTML, PHP and MySQL.  Currently exploring Vue.JS, Cloudflare Workers KV and D1.  I am interested in learning new languages and technologies for personal and professional projects, with previous experience using Golang, Java and Google Apps Script.",
    ]
  },
  employment : [
    {
      employer : "Ennov, St. Neots",
      role : "Development Engineer",
      from : "2021-11",
      to : "Present",
      description : "I am part of a scrum team designing, developing and maintaining a pharmacovigilance web application, using Angular, Java and Oracle database.",
      skills : ["Oracle", "HTML", "CSS", "JavaScript", "TypeScript", "Angular", "Jenkins", "Solr", "Linux", "SQL", "REST APIs", "Java", "Liquibase", "IntelliJ IDEA", "Scrum", "Git", "Microservices", "Golang", "DevExtreme", "Spring Data JPA", "Bash Scripting", "Jasmine", "Redmine"],
      bullets : [
        "Developing API endoints for RESTful microservices using Spring Boot",
        "Communicating progress, and discussion of potential issues in daily standup meetings",
        "Creating and maintaining Angular front-end functionality",
        "Maintaining deployment pipelines using Jenkins",
        "Proficient in Jasmine for testing JavaScript applications"
      ]
    },
    {
      employer : "Ennov, St. Neots",
      role : "Software Support Analyst",
      from : "2013-11",
      to : "2021-11",
      description : "Experienced in managing and supporting a pharmacovigilance database, troubleshooting software issues and providing user support, and ensuring data integrity withing the database.",
      skills : ["Oracle", "SQL", "Liquibase", "RemoteApp", "AutoIt3", "PV-Works", "Batch Scripting", "Google Apps Script", "Webhooks"],
      bullets : [
        "Provided technical support and training for users, addressing support tickets promptly",
        "Implemented system and database enhancements to improve functionality",
        "Produced monthly issue reports for customers",
        "Designed, developed and maintained C# .NET utilities for internal use by the support team",
        "Developed a web interface to help customers troubleshoot connectivity issues with our services"
      ]
    },
    {
      employer : "Tensor, St. Neots",
      role : "Helpdesk Analyst",
      from : "2010-07",
      to : "2013-10",
      description : "Application and hardware support for customers using Tensor time and attendance, access control, personnel and energy management systems. Security vetted as non-police personnel by West Midlands Police.",
      skills : ["Microsoft SQL", "MSDE", "SimpleHelp", "Remote Access"],
      bullets : [
        "Microsoft SQL and MSDE database configuration and support",
        "Hardware installation advice given to electrical engineers",
        "Firmware and software upgrades performed using remote access tools",
        "Application server migration and software installation support"
      ]
    },
    {
      employer : "NHS Anglia Support Partnership, Huntingdon",
      role : "Service Desk Analyst",
      from : "2010-02",
      to : "2010-07",
      description : "First line service desk role delivering IT and Facilities support to NHS Strategic Health Authority and Primary Care Trust staff across the Anglia region.",
      skills : ["Microsoft Office", "Microsoft Active Directory", "Microsoft Outlook", "Hornbill Service Desk"],
      bullets : [
        "Microsoft Windows Active Directory account administration",
        "Microsoft Exchange 2007 account management via OWA",
        "NHS Trust IT and email policy enforcement",
        "Microsoft Office 2003/2007 application support"
      ]
    },
    {
      employer : "Itim, Huntingdon",
      role : "Software Support Analyst",
      from : "2006-12",
      to : "2010-02",
      description : "Second line support role, including out-of-hours support for retailers in the UK and Europe using Itim end-to-end retail applications.",
      skills : ["EPOS", "EFT", "YesPay", "Microsoft SQL", "DP4", "Remote Access", "VNC"],
      bullets : [
        "EFT and EPoS software and hardware support for shop floor and back office staff",
        "Responsible for EPoS provision and management for new and refitted stores",
        "Incident resolution using remote access applications",
        "Microsoft SQL and DP4 database management"
      ]
    },
    {
      employer : "iCare UK, St. Neots",
      role : "Support Technician",
      from : "2005-05",
      to : "2006-11",
      description : "IT support role for UK and European customers in small or home office environments. In addition to this role I provided administrative support to Sales staff.",
      skills : ["MacOS X", "Microsoft Windows", "Microsoft Office"],
      bullets : [
        "Provided Microsoft Windows and Office application support to customers",
        "Maintained records of customer requests, incidents and assets",
        "Produced quotes, invoices and contracts for scheduled work",
        "Gave technical sales advice to customers"
      ]
    },
    {
      employer : "Hotspot Bakery, St. Neots",
      role : "Baker",
      from : "2004-06",
      to : "2006-11",
      description : "A skilled baker with experience producing frozen pies, pastries, bread and cakes while maintaining high standards of quality and safety.",
      skills : [],
      bullets : [
        "Operated bakery equipment and maintained a clean workspace to comply with regulations",
        "Managed inventory of ingredients and supplies to meet production demands",
        "Ensured quality and standards to maintain product consistency",
        "Contributed with team members to increase efficiency of the production process"
      ]
    },
    {
      employer : "T-Auctions",
      role : "Hardware Technician",
      from : "2003-07",
      to : "2004-06",
      description : "IT recycling technician with hands-on experience in managing the lifecycle of decimmissioned electronic equipment.",
      skills : [],
      bullets : [
        "Effienciently processed pallets of printers, monitors, desktop and notebook computers",
        "Destroyed data to ensure compliance with data protection regulations",
        "Cleaned and refurbished devices to meet quality standards for resale",
        "Imaged devices and prepared them for onsite, and online auction sales"
      ]
    }
  ],
  education : [
    {
      institute : "The Open University",
      location : "Milton Keynes, Buckinghamshire",
      from : "2014-02",
      to : "Present",
      display : "list",
      courses : [
        {
          name : "Web Technologies (TT284)",
          level : ""
        },
        {
          name : "Discovering Mathematics (MU123)",
          level : ""
        },
        {
          name : "Technologies in Practice (TM129)",
          level : ""
        },
        {
          name : "My Digital Life (TU100)",
          level : ""
        }
      ]
    },
    {
      institute : "Peterborough Regional College",
      location : "Peterborough, Cambridgeshire",
      from : "1999-09",
      to : "2003",
      display : "list",
      courses : [
        {
          name : "Information & Communication Technology",
          level : "GNVQ Intermediate"
        },
        {
          name : "Sports, Recreation and Allied Occupations Leadership",
          level : "NVQ Level 2"
        },
        {
          name : "Adult Numeracy",
          level : "NVQ Level 1"
        }
      ]
    },
    {
      institute : "Ernulf Community School",
      location : "St. Neots, Cambridgeshire",
      from : "1993-09",
      to : "1998",
      display : "csv",
      courses : [
        {
          name : "English",
          level : "GCSE"
        },
        {
          name : "Humanities",
          level : "GCSE"
        },
        {
          name : "Mathematics",
          level : "GCSE"
        },
        {
          name : "Music",
          level : "GCSE"
        },
        {
          name : "Science",
          level : "GCSE"
        },
        {
          name : "Theatre Studies",
          level : "GCSE"
        }
      ]
    }
  ],
  interests : [
    "I regularly play inline hockey with St. Neots Sharks.  As a member of the club committee I am responsible for provision of email and web hosting services.  Skaters confirm attendance for each session using an online register, which I developed and maintain using PHP, Vue.JS and SQLite/MariaDB",
    "I am passionate about information technology, with emphasis on on cybersecurity and open-source operating systems.  As a Linux enthusiast, I actively maintain a home lab comprising several selfhosted services, which help me develop my computing knowledge."
  ],
  getContact : function()
  {
    return this.contact;
  },
  getEmployers : function()
  {
    return this.employment;
  },
  getEducators : function()
  {
    return this.education;
  },
  getInterests : function()
  {
    return this.interests;
  }
}

function addItem(id, val)
{
  if (id === "link") {
    let link = JSON.parse(val)
    val = `<a href="${link.url}" target="_blank">${link.text}</a>`;
  }
  
  document.getElementById(id).insertAdjacentHTML("beforeend", val);
}

function getPeriod(datePeriod)
{
  let d, v;
  if (datePeriod == "Present")
  {
    v = datePeriod;
  }
  else
  {
    d = new Date(datePeriod);
    v = getMonthName(d.getMonth()) + ", " + d.getFullYear();
  }
  return v;
}

function getMonthName(m)
{
  let months = [
    "January",
    "February",
    "March",
    "April",
    "May",
    "June",
    "July",
    "August",
    "September",
    "October",
    "November",
    "December"
  ];
  return months[m];
}

function getDuration(dateFrom, dateTo)
{
  let from = new Date(dateFrom); // create date object
  let to = (dateTo == "Present") ? new Date() : new Date(dateTo); // use today's date if to is 'Present'

  let monthsCalc = to.getMonth() - from.getMonth(); // calculate months between
  let yearsCalc = (12 * (to.getFullYear() - from.getFullYear()));
  let monthsTotal = monthsCalc + yearsCalc;

  return { "years" : Math.floor(monthsTotal / 12), "months" : monthsTotal%12 };
}

/**
 * Build the page
 */
addItem("name", `${me.getContact().firstname} ${me.getContact().surname}`);
addItem("phone", `${me.getContact().phone}`);
addItem("email", `${me.getContact().email}`);
addItem("link", `${JSON.stringify(me.getContact().link)}`);

me.getEmployers().forEach(j => addItem("employment", `
  <div class="job">
    <h4><i class="fa-solid fa-user"></i>${j.role}</h4>
    <div class="employer"><i class="fa-regular fa-building"></i>${j.employer}<span class="fromto"><i class="fa-regular fa-calendar"></i>${getPeriod(j.from)} &ndash; ${getPeriod(j.to)}</span></div>
    <div class="description">${j.description}</div>
    <ul>
      ${j.bullets.length > 0 ? `<li>${j.bullets.join("</li><li>")}</li>` : '' }
    </ul>
    <div style="font-size: smaller; font-style: italic;" class="skills">${j.skills.sort().join(", ")}</div>
  </div>
`));

me.getEducators().forEach(e => addItem("education", `
  <div class="school">
    <h4><i class="fa-solid fa-building-columns"></i>${e.institute}</h4>
    <div class="location"><i class="fa-solid fa-location-dot"></i>${e.location}<span class="fromto"><i class="fa-regular fa-calendar"></i>${getPeriod(e.from)} &ndash; ${getPeriod(e.to)}</span></div>
    <ul>
      <li>${e.courses.map(c => c.name + (c.level.length > 0 ? `, <span class="level">${c.level}</span>` : "")).join("</li><li>")}</li>
    </ul>
  </div>
`));

me.getInterests().forEach(i => addItem("interests", `
  <p>${i}</p>
`));

me.getContact().about.forEach(i => addItem("contact", `
  <p>${i}</p>
  `));